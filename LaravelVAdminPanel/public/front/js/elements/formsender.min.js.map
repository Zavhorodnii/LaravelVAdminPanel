{"version":3,"sources":["elements/formsender.js"],"names":["document","addEventListener","form","getElementById","formAddError","input","parentElement","classList","add","formRemoveError","remove","emailTest","test","value","async","e","preventDefault","error","formReq","querySelectorAll","index","length","contains","getAttribute","checked","formValidate","Event","elem1","elem","formImage","formPreview","file","includes","type","alert","size","reader","FileReader","onload","innerHTML","target","result","onerror","readAsDataURL","uploadFile","files"],"mappings":"AAAA,aAEAA,SAASC,iBAAiB,oBAAoB,WAC5C,MAAMC,EAAOF,SAASG,eAAe,QAmDrC,SAASC,EAAaC,GACpBA,EAAMC,cAAcC,UAAUC,IAAI,UAClCH,EAAME,UAAUC,IAAI,UAGtB,SAASC,EAAgBJ,GACvBA,EAAMC,cAAcC,UAAUG,OAAO,UACrCL,EAAME,UAAUG,OAAO,UAGzB,SAASC,EAAUN,GACjB,OAAQ,gDAAgDO,KAAKP,EAAMQ,OA7DjEX,GACFA,EAAKD,iBAAiB,UAExBa,eAAwBC,GACtBA,EAAEC,iBAEF,IAAIC,EAkBN,SAAsBf,GACpB,IAAIe,EAAQ,EACRC,EAAUlB,SAASmB,iBAAiB,SAExC,IAAK,IAAIC,EAAQ,EAAGA,EAAQF,EAAQG,OAAQD,IAAS,CACnD,MAAMf,EAAQa,EAAQE,GACtBX,EAAgBJ,GAEZA,EAAME,UAAUe,SAAS,UACvBX,EAAUN,KACZD,EAAaC,GACbY,MAEsC,aAA/BZ,EAAMkB,aAAa,UAA4C,IAAlBlB,EAAMmB,SAIxC,KAAhBnB,EAAMQ,SAHVT,EAAaC,GACbY,KAQJ,OAAOA,EAzCKQ,GAEA,IAAIC,MAAM,SACtB,MAAMC,EAAQ3B,SAASG,eAAe,SAChCyB,EAAO5B,SAASG,eAAe,UACvB,IAAVc,GAEEW,IACFD,EAAMpB,UAAUG,OAAO,QACvBkB,EAAKrB,UAAUC,IAAI,YAkDzB,MAAMqB,EAAY7B,SAASG,eAAe,aAEpC2B,EAAc9B,SAASG,eAAe,eAGxC0B,GACFA,EAAU5B,iBAAiB,SAAU,MAMvC,SAAoB8B,GAElB,IAAK,CAAC,aAAc,YAAa,aAAaC,SAASD,EAAKE,MAG1D,OAFAC,MAAM,sCACNL,EAAUhB,MAAQ,IAIpB,GAAIkB,EAAKI,KAAO,QAEd,YADAD,MAAM,gCAIR,IAAIE,EAAS,IAAIC,WACjBD,EAAOE,OAAS,SAAUvB,GACxBe,EAAYS,UAAY,aAAaxB,EAAEyB,OAAOC,uBAEhDL,EAAOM,QAAU,SAAU3B,GACzBmB,MAAM,WAERE,EAAOO,cAAcZ,GAzBnBa,CAAWf,EAAUgB,MAAM","file":"formsender.min.js","sourcesContent":["\"use strict\"\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n  const form = document.getElementById('form');\r\n  if (form) {\r\n    form.addEventListener('submit', formSend);\r\n  }\r\n  async function formSend(e) {\r\n    e.preventDefault();\r\n\r\n    let error = formValidate(form);\r\n\r\n    let event = new Event(\"click\");\r\n    const elem1 = document.getElementById('popup');\r\n    const elem = document.getElementById('popup2');\r\n    if (error === 0) {\r\n\r\n      if (elem) {\r\n        elem1.classList.remove('open');\r\n        elem.classList.add('open');\r\n      }\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  function formValidate(form) {\r\n    let error = 0;\r\n    let formReq = document.querySelectorAll('._req');\r\n\r\n    for (let index = 0; index < formReq.length; index++) {\r\n      const input = formReq[index];\r\n      formRemoveError(input);\r\n\r\n      if (input.classList.contains('_email')) {\r\n        if (emailTest(input)) {\r\n          formAddError(input);\r\n          error++;\r\n        }\r\n      } else if (input.getAttribute(\"type\") === \"checkbox\" && input.checked === false) {\r\n        formAddError(input);\r\n        error++;\r\n      } else {\r\n        if (input.value === '') {\r\n          formAddError(input);\r\n          error++;\r\n        }\r\n      }\r\n    }\r\n    return error;\r\n  }\r\n\r\n  function formAddError(input) {\r\n    input.parentElement.classList.add('_error');\r\n    input.classList.add('_error');\r\n  }\r\n\r\n  function formRemoveError(input) {\r\n    input.parentElement.classList.remove('_error');\r\n    input.classList.remove('_error');\r\n  }\r\n  //Функция теста email\r\n  function emailTest(input) {\r\n    return !/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,8})+$/.test(input.value);\r\n  }\r\n\r\n  //Получаем инпут file в переменную\r\n  const formImage = document.getElementById('formImage');\r\n  //Получаем див для превью в переменную\r\n  const formPreview = document.getElementById('formPreview');\r\n\r\n  //Слушаем изменения в инпуте file\r\n  if (formImage) {\r\n    formImage.addEventListener('change', () => {\r\n      uploadFile(formImage.files[0]);\r\n    });\r\n  }\r\n\r\n\r\n  function uploadFile(file) {\r\n    // провераяем тип файла\r\n    if (!['image/jpeg', 'image/png', 'image/gif'].includes(file.type)) {\r\n      alert('Разрешены только изображения.');\r\n      formImage.value = '';\r\n      return;\r\n    }\r\n    // проверим размер файла (<2 Мб)\r\n    if (file.size > 2 * 1024 * 1024) {\r\n      alert('Файл должен быть менее 2 МБ.');\r\n      return;\r\n    }\r\n\r\n    var reader = new FileReader();\r\n    reader.onload = function (e) {\r\n      formPreview.innerHTML = `<img src=\"${e.target.result}\" alt=\"Фото\">`;\r\n    };\r\n    reader.onerror = function (e) {\r\n      alert('Ошибка');\r\n    };\r\n    reader.readAsDataURL(file);\r\n  }\r\n});\r\n"]}